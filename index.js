function S(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?S=function(e){return typeof e}:S=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(n)}function He(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function le(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function Le(n,t,e){return t&&le(n.prototype,t),e&&le(n,e),n}var qe=function(){function n(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(He(this,n),S(t)==="object"){var r=n.fromObject(t);this.x=r.x,this.y=r.y}else this.x=t,this.y=e}return Le(n,[{key:"add",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0,i=n.from(e,r);return new n(this.x+i.x,this.y+i.y)}},{key:"subtract",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0,i=n.from(e,r);return new n(this.x-i.x,this.y-i.y)}},{key:"multiply",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,r=arguments.length>1?arguments[1]:void 0,i=n.from(e,r);return new n(this.x*i.x,this.y*i.y)}},{key:"divide",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,r=arguments.length>1?arguments[1]:void 0,i=n.from(e,r);return new n(this.x/i.x,this.y/i.y)}},{key:"mod",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,r=arguments.length>1?arguments[1]:void 0,i=n.from(e,r);return new n(this.x%i.x,this.y%i.y)}},{key:"ceil",value:function(){return new n(Math.ceil(this.x),Math.ceil(this.y))}},{key:"floor",value:function(){return new n(Math.floor(this.x),Math.floor(this.y))}},{key:"round",value:function(){return new n(Math.fround(this.x),Math.fround(this.y))}},{key:"abs",value:function(){return new n(Math.abs(this.x),Math.abs(this.y))}},{key:"distance",value:function(e,r){return Math.sqrt(this.distanceSquared(e,r))}},{key:"distanceSquared",value:function(e,r){var i=n.from(e,r);return Math.pow(this.x-i.x,2)+Math.pow(this.y-i.y,2)+Math.pow(this.z-i.z,2)}},{key:"clone",value:function(){return new n(this.x,this.y)}}],[{key:"from",value:function(e,r){return S(e)==="object"?this.fromObject(e):typeof e=="number"?new n(e,typeof r=="number"?r:e):(console.error("Invalid value given : "),console.error(e),new n)}},{key:"fromObject",value:function(e){return e instanceof n?e:e.w!==void 0&&e.h!==void 0?new n(e.w,e.h):e.width!==void 0&&e.height!==void 0?new n(e.width,e.height):(console.error("Invalid obj given : "),console.error(e),new n)}}]),n}(),f=qe;function P(n,t,e){return Ne()?P=Reflect.construct:P=function(i,o,u){var s=[null];s.push.apply(s,o);var a=Function.bind.apply(i,s),h=new a;return u&&$(h,u.prototype),h},P.apply(null,arguments)}function Ne(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function $(n,t){return $=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},$(n,t)}function he(n){return Ye(n)||Xe(n)||ze(n)||Ue()}function Ue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ze(n,t){if(!!n){if(typeof n=="string")return K(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);if(e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set")return Array.from(n);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return K(n,t)}}function Xe(n){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(n))return Array.from(n)}function Ye(n){if(Array.isArray(n))return K(n)}function K(n,t){(t==null||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function Je(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function me(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function Ge(n,t,e){return t&&me(n.prototype,t),e&&me(n,e),n}var $e=function(){function n(t){var e=this;Je(this,n),this.activities=[],this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.mouseVec=new f,this.elapsedSecs=0,this.lastUpdate=-1,this.ctx.webkitImageSmoothingEnabled=!1,this.ctx.mozImageSmoothingEnabled=!1,this.ctx.imageSmoothingEnabled=!1,this.canvas.onclick=function(r){if(r.button===0){var i=P(f,he(e.canvas.calcMousePoint(r,1024)));e.activities.slice().reverse().some(function(o){return o.mouseClick(i,i.add(o.camera))})}},this.canvas.onmousemove=function(r){e.mouseVec=P(f,he(e.canvas.calcMousePoint(r,1024)))}}return Ge(n,[{key:"update",value:function(){var e=this,r=Date.now();if(this.lastUpdate!==-1){var i=this.lastUpdate===-1?0:r-this.lastUpdate;this.ctx.fillRect(0,0,this.width,this.height),this.activities=this.activities.filter(function(o,u){return o.isDestroyed?!1:(o.update(i),o.render(e.ctx),!0)})}this.lastUpdate=r,this.activities.slice().reverse().some(function(o){return o.mouseHover(e.mouseVec,e.mouseVec.add(o.camera))}),requestAnimationFrame(this.update.bind(this))}},{key:"addActivity",value:function(e){this.activities.push(e)}},{key:"width",get:function(){return this.canvas?this.canvas.width:0}},{key:"height",get:function(){return this.canvas?this.canvas.height:0}}]),n}(),pe=$e;function Ke(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function ye(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function Qe(n,t,e){return t&&ye(n.prototype,t),e&&ye(n,e),n}var Ze=function(){function n(){Ke(this,n),this._hidden=!1,this._absolute=!1,this._scale=1,this._rotate=0,this._hue=0,this._brightness=1,this._contrast=1,this._grayscale=!1,this._drawBox=null}return Qe(n,[{key:"hidden",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._hidden=e,this}},{key:"absolute",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._absolute=e,this}},{key:"scale",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return this._scale=e,this}},{key:"rotate",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this._rotate=e,this}},{key:"hue",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this._hue=e,this}},{key:"brightness",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return this._brightness=e,this}},{key:"contrast",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return this._contrast=e,this}},{key:"grayscale",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._grayscale=e,this}},{key:"drawBox",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this._drawBox=e,this}},{key:"applyFilter",value:function(e){var r=e.filter==="none"?"":e.filter;this._rotate!==0&&e.rotate(-this._rotate),this._hue!==0&&(r+=" hue-rotate(".concat(this._hue,"deg) ")),this._brightness!==1&&(r+=" brightness(".concat(this._brightness,") ")),this._contrast!==1&&(r+=" contrast(".concat(this._contrast,") ")),this._grayscale&&(r+=" grayscale(1) "),this._drawBox&&(e.rect(this._drawBox.minX,this._drawBox.minY,this._drawBox.maxX,this._drawBox.maxY),e.clip(),e.clearRect(this._drawBox.minX,this._drawBox.minY,this._drawBox.maxX,this._drawBox.maxY)),e.filter=r}}],[{key:"hidden",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return new n().hidden(e)}},{key:"absolute",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return new n().absolute(e)}},{key:"scale",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return new n().scale(e)}},{key:"rotate",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new n().rotate(e)}},{key:"hue",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new n().hue(e)}},{key:"brightness",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return new n().brightness(e)}},{key:"contrast",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return new n().contrast(e)}},{key:"grayscale",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return new n().grayscale(e)}},{key:"drawBox",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return new n().drawBox(e)}}]),n}(),d=Ze;function et(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function de(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function tt(n,t,e){return t&&de(n.prototype,t),e&&de(n,e),n}var nt=function(){function n(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;et(this,n),this.children=[],this.isDestroyed=!1,this.onUpdate=function(e,r){},this.onRender=function(e,r){},this.onDestroy=function(e){},this.onMouseClick=function(e,r,i){return!1},this.onMouseHover=function(e,r,i){return!1},this.onMouseHoverOut=function(e){},this.setRenderOption(t),this.init()}return tt(n,[{key:"init",value:function(){}},{key:"update",value:function(e){this.children=this.children.filter(function(r,i){return r.isDestroyed?!1:(r.update(e),!0)}),this.hoverOutDelay>0&&(this.hoverOutDelay-=e,this.hoverOutDelay<=0&&(this.hoverOutDelay=0,this.onMouseHoverOut(this))),this.onUpdate(e,this)}},{key:"render",value:function(e){if(!(this.isDestroyed||this.isHidden())){if(e.save(),this.renderOption.applyFilter(e),this.children.forEach(function(i){e.save(),i.render(e),e.restore()}),this.onRender(e,this),new URLSearchParams(window.location.search).get("renderBoundingBox")){var r=this.getBoundingBox();r&&(e.beginPath(),e.moveTo(r.minX,r.minY),e.lineTo(r.minX,r.maxY),e.lineTo(r.maxX,r.maxY),e.lineTo(r.maxX,r.minY),e.closePath(),e.stroke())}e.restore()}}},{key:"mouseClick",value:function(e,r){if(this.isDestroyed)return!1;var i=this.getBoundingBox();return!i||!i.isVectorInside(this.isAbsolute()?e:r)?!1:this.onMouseClick(e,r,this)||this.children.slice().reverse().findIndex(function(o){return o.mouseClick(e,r)})!==-1}},{key:"mouseHover",value:function(e,r){if(this.isDestroyed)return!1;var i=this.getBoundingBox();return!i||!i.isVectorInside(this.isAbsolute()?e:r)?!1:(this.hoverOutDelay=20,this.onMouseHover(e,r,this)||this.children.slice().reverse().findIndex(function(o){return o.mouseHover(e,r)})!==-1)}},{key:"destroy",value:function(){this.isDestroyed=!0,this.onDestroy(this)}},{key:"setOnUpdate",value:function(e){return this.onUpdate=e,this}},{key:"setOnRender",value:function(e){return this.onRender=e,this}},{key:"setOnMouseClick",value:function(e){return this.onMouseClick=e,this}},{key:"setOnMouseHover",value:function(e){return this.onMouseHover=e,this}},{key:"setOnMouseHoverOut",value:function(e){return this.onMouseHoverOut=e,this}},{key:"setRenderOption",value:function(e){return this.renderOption=e||new d,this}},{key:"isAbsolute",value:function(){return this.renderOption._absolute}},{key:"isHidden",value:function(){return this.renderOption._hidden}},{key:"isHover",value:function(){return this.hoverOutDelay>0}},{key:"getScale",value:function(){return this.renderOption._scale}},{key:"getDrawBox",value:function(){return this.renderOption._drawBox}},{key:"getBoundingBox",value:function(){return null}}]),n}(),j=nt;function rt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function ge(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function it(n,t,e){return t&&ge(n.prototype,t),e&&ge(n,e),n}var ot=function(){function n(t,e){rt(this,n),this.min=new f(Math.min(t.x,e.x),Math.min(t.y,e.y)),this.max=new f(Math.max(t.x,e.x),Math.max(t.y,e.y))}return it(n,[{key:"isInside",value:function(e,r){return this.min.x<e&&this.max.x>e&&this.min.y<r&&this.max.y>r}},{key:"isVectorInside",value:function(e){return this.min.x<e.x&&this.max.x>e.x&&this.min.y<e.y&&this.max.y>e.y}},{key:"add",value:function(e,r){var i=f.from(e,r);return new n(this.min.add(i),this.max.add(i))}},{key:"subtract",value:function(e,r){var i=f.from(e,r);return new n(this.min.subtract(i),this.max.subtract(i))}},{key:"expand",value:function(e,r){var i=f.from(e,r);return new n(this.min.subtract(i),this.max.add(i))}},{key:"contract",value:function(e,r){var i=f.from(e,r);return new n(this.min.add(i),this.max.subtract(i))}},{key:"floor",value:function(){return n.from(this.min.floor(),this.max.floor())}},{key:"clone",value:function(){return n.from(this.min,this.max)}},{key:"minX",get:function(){return this.min.x}},{key:"minY",get:function(){return this.min.y}},{key:"maxX",get:function(){return this.max.x}},{key:"maxY",get:function(){return this.max.y}},{key:"xLength",get:function(){return this.max.x-this.min.x}},{key:"yLength",get:function(){return this.max.y-this.min.y}}],[{key:"from",value:function(e,r,i,o){return new n(f.from(e,i),f.from(r===void 0?e:r,o===void 0?i:o))}}]),n}(),O=ot;function E(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?E=function(e){return typeof e}:E=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(n)}function ut(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function ve(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function at(n,t,e){return t&&ve(n.prototype,t),e&&ve(n,e),n}function st(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&Q(n,t)}function Q(n,t){return Q=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Q(n,t)}function lt(n){var t=ct();return function(){var r=A(n),i;if(t){var o=A(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return ft(this,i)}}function ft(n,t){return t&&(E(t)==="object"||typeof t=="function")?t:ht(n)}function ht(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function ct(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function A(n){return A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},A(n)}var mt=function(n){st(e,n);var t=lt(e);function e(r){var i;return ut(this,e),i=t.call(this),i.app=r,i.camera=new f(0,0),i}return at(e,[{key:"addWidget",value:function(i){this.children.push(i),i.app=this.app,i.activity=this}},{key:"render",value:function(i){var o=this;this.isDestroyed||this.isHidden()||this.children.forEach(function(u){u.isAbsolute()||(i.save(),i.translate(-o.camera.x,-o.camera.y)),u.render(i),u.isAbsolute()||i.restore()})}},{key:"getBoundingBox",value:function(){return O.from(0,this.app.canvas)}},{key:"isAbsolute",value:function(){return!0}}]),e}(j),be=mt;import pt from"../sprite/ui/text.png";import yt from"../sprite/ui/background.png";import dt from"../sprite/ui/icon.png";import gt from"../sprite/character/pink_man.png";import vt from"../sprite/character/mask_man.png";import bt from"../sprite/character/ninja_frog.png";import _t from"../sprite/character/virtual_guy.png";import wt from"../sprite/particle/character_appearing.png";import Ot from"../sprite/particle/collected_item.png";function _e(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),e.push.apply(e,r)}return e}function kt(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?_e(Object(e),!0).forEach(function(r){xt(n,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):_e(Object(e)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(e,r))})}return n}function xt(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var we=pt,Oe=yt,xe=dt;var St=gt,Pt=vt,Rt=bt,Bt=_t,x={PinkMan:St,MaskMan:Pt,NinjaFrog:Rt,VirtualGuy:Bt},ir=kt({},x),jt=wt,Et=Ot,I={CharacterAppearing:jt,CollectedItem:Et};function At(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function ke(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function It(n,t,e){return t&&ke(n.prototype,t),e&&ke(n,e),n}var Mt=function(){function n(t,e,r,i,o,u){At(this,n),this.w=t||0,this.h=e||0,this.sx=r||0,this.sy=i||0,this.ox=o||0,this.oy=u||0}return It(n,[{key:"image",get:function(){return this._image||(this._image=new Image),this._image},set:function(e){e instanceof HTMLImageElement?this._image=e:(typeof e=="string"||e instanceof String)&&(this._image=new Image,this._image.src=e)}},{key:"setImage",value:function(e){return this.image=e,this}},{key:"update",value:function(e){}},{key:"draw",value:function(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;if(!(!this.image.complete||this.image.naturalHeight===0)){var o=f.from(r);e.save(),e.translate(o.x,o.y),e.drawImage(this.image,this.sx,this.sy,this.w,this.h,-this.ox*i/2,-this.oy*i/2,this.w*i,this.h*i),e.restore()}}}],[{key:"fromJson",value:function(e){var r=e.w,i=e.h,o=e.sx,u=e.sy,s=e.ox,a=e.oy;return new n(r,i,o,u,s,a)}}]),n}(),R=Mt;import Tt from"../sprite/ui/text.json";import Ct from"../sprite/ui/background.json";import Ft from"../sprite/ui/icon.json";function Z(n,t){var e=new Map;return t.forEach(function(r){e.set(r.hasOwnProperty("name")?r.name:e.size,R.fromJson(r).setImage(n))}),e}var Se=Z(we,Tt),ee=Z(Oe,Ct),M=Z(xe,Ft);function T(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?T=function(e){return typeof e}:T=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(n)}function Dt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function Pe(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function Wt(n,t,e){return t&&Pe(n.prototype,t),e&&Pe(n,e),n}function C(n,t,e){return typeof Reflect!="undefined"&&Reflect.get?C=Reflect.get:C=function(i,o,u){var s=Re(i,o);if(!!s){var a=Object.getOwnPropertyDescriptor(s,o);return a.get?a.get.call(u):a.value}},C(n,t,e||n)}function Vt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&te(n,t)}function te(n,t){return te=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},te(n,t)}function qt(n){var t=Lt();return function(){var r=_(n),i;if(t){var o=_(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return Ht(this,i)}}function Ht(n,t){return t&&(T(t)==="object"||typeof t=="function")?t:Be(n)}function Be(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Lt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function F(n,t,e,r){return typeof Reflect!="undefined"&&Reflect.set?F=Reflect.set:F=function(o,u,s,a){var h=Re(o,u),c;if(h){if(c=Object.getOwnPropertyDescriptor(h,u),c.set)return c.set.call(a,s),!0;if(!c.writable)return!1}if(c=Object.getOwnPropertyDescriptor(a,u),c){if(!c.writable)return!1;c.value=s,Object.defineProperty(a,u,c)}else Nt(a,u,s);return!0},F(n,t,e,r)}function Ut(n,t,e,r,i){var o=F(n,t,e,r||n);if(!o&&i)throw new Error("failed to set property");return e}function Nt(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function Re(n,t){for(;!Object.prototype.hasOwnProperty.call(n,t)&&(n=_(n),n!==null););return n}function _(n){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_(n)}var zt=function(n){Vt(e,n);var t=qt(e);function e(r,i){var o,u,s=i.fps,a=i.w,h=i.h,c=i.ox,p=i.oy,b=i.sx,g=i.sy,m=i.count;Dt(this,e),u=t.call(this,a,h,b,g,c,p),Ut((o=Be(u),_(e.prototype)),"image",r,o,!0),u.frames=[],u.count=0,u.fps=s,u.loop=-1,u.elapsedSecs=0,u.onAnimationEnd=null;for(var y=0;y<m;++y)u.frames[y]=new R(a,h,b+y*a,g,c,p).setImage(r),++u.count;return u}return Wt(e,[{key:"setImage",value:function(i){var o=this;return C(_(e.prototype),"setImage",this).call(this,i),this.frames.forEach(function(u){return u.image=o.image}),this}},{key:"frame",get:function(){var i=this.frames[Math.floor(this.elapsedSecs/this.fps)];return i||(this.loop!==0?(this.loop!==-1&&--this.loop,this.elapsedSecs=0,i=this.frames[0]):(i=this.frames[this.frames.length-1],this.onAnimationEnd&&this.onAnimationEnd(this))),i||null}},{key:"setFps",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:60;return this.fps=i,this}},{key:"setLoop",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1;return this.loop=i,this}},{key:"setOnAnimationEnd",value:function(i){return this.onAnimationEnd=i,this}},{key:"update",value:function(i){this.elapsedSecs+=i}},{key:"draw",value:function(i,o){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=this.frame;s!==null&&s.draw(i,o,u)}},{key:"reset",value:function(){this.elapsedSecs=0}},{key:"clone",value:function(){return new e(this.image,this)}}]),e}(R),w=zt;import ne from"../sprite/character/default_character.animation.json";import Xt from"../sprite/particle/collected_item.json";import je from"../sprite/particle/character_appearing.json";var k={idle:function(t){return new w(t,ne.idle)},run:function(t){return new w(t,ne.run)},hit:function(t){return new w(t,ne.hit)}},re={in:function(){return new w(I.CharacterAppearing,je.in)},out:function(){return new w(I.CharacterAppearing,je.out)}},Ee=new w(I.CollectedItem,Xt);function D(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?D=function(e){return typeof e}:D=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(n)}function Yt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function Ae(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function Jt(n,t,e){return t&&Ae(n.prototype,t),e&&Ae(n,e),n}function Gt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&ie(n,t)}function ie(n,t){return ie=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},ie(n,t)}function Qt(n){var t=Kt();return function(){var r=W(n),i;if(t){var o=W(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return $t(this,i)}}function $t(n,t){return t&&(D(t)==="object"||typeof t=="function")?t:Zt(n)}function Zt(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Kt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function W(n){return W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},W(n)}var en=function(n){Gt(e,n);var t=Qt(e);function e(){var r,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return Yt(this,e),r=t.call(this,o),r.app=null,r.activity=null,r.setPos(i),r}return Jt(e,[{key:"setPos",value:function(i){return this.pos=i||new f(0,0),this}}]),e}(j),V=en;function H(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?H=function(e){return typeof e}:H=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(n)}function tn(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function Ie(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function nn(n,t,e){return t&&Ie(n.prototype,t),e&&Ie(n,e),n}function rn(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&oe(n,t)}function oe(n,t){return oe=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},oe(n,t)}function an(n){var t=un();return function(){var r=L(n),i;if(t){var o=L(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return on(this,i)}}function on(n,t){return t&&(H(t)==="object"||typeof t=="function")?t:sn(n)}function sn(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function un(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function L(n){return L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},L(n)}var Me=8,Te=10,fn=function(n){rn(e,n);var t=an(e);function e(r,i){var o,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return tn(this,e),o=t.call(this,r,u),o.text=i,o}return nn(e,[{key:"init",value:function(){var i=this;this.onRender=function(o){for(var u=i.getScale()/2,s=Me*u,a=Te*u,h=i.text.split(`
`),c=h.length,p=0;p<c;++p)for(var b=h[p],g=b.length,m=0;m<g;++m){var y=Se.get(b.charAt(m).toLowerCase());y&&y.draw(o,i.pos.subtract((g-m*2)*s,(c-p*2)*a),i.getScale())}}}},{key:"getBoundingBox",value:function(){var i=this.text.split(`
`),o=i.reduce(function(s,a){return Math.max(s,a.length)},0),u=new f(o*Me,i.length*Te).multiply(this.getScale()/2);return O.from(this.pos).expand(u)}},{key:"setText",value:function(i){return this.text=i,this}}]),e}(V),ue=fn;function q(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?q=function(e){return typeof e}:q=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(n)}function cn(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function Ce(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function ln(n,t,e){return t&&Ce(n.prototype,t),e&&Ce(n,e),n}function hn(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&ae(n,t)}function ae(n,t){return ae=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},ae(n,t)}function yn(n){var t=pn();return function(){var r=N(n),i;if(t){var o=N(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return mn(this,i)}}function mn(n,t){return t&&(q(t)==="object"||typeof t=="function")?t:dn(n)}function dn(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function pn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function N(n){return N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},N(n)}var gn=function(n){hn(e,n);var t=yn(e);function e(r,i){var o,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return cn(this,e),o=t.call(this,r,u),o.sprite=i,o}return ln(e,[{key:"init",value:function(){var i=this;this.onRender=function(o){if(!(!i.sprite||!i.sprite.image||!i.sprite.image.complete)){var u=f.from(i.sprite).multiply(i.getScale()/2);i.sprite.draw(o,i.pos.subtract(u),i.getScale())}},this.onUpdate=function(o){i.sprite.update(o)}}},{key:"getBoundingBox",value:function(){if(!this.sprite)return null;var i=f.from(this.sprite).multiply(this.getScale()/2);return O.from(this.pos.subtract(new f(this.sprite.ox,this.sprite.oy).multiply(this.getScale()/2))).expand(i)}},{key:"setSprite",value:function(i){return this.sprite=i,this}}]),e}(V),v=gn;function U(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?U=function(e){return typeof e}:U=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(n)}function vn(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function Fe(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function bn(n,t,e){return t&&Fe(n.prototype,t),e&&Fe(n,e),n}function _n(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&se(n,t)}function se(n,t){return se=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},se(n,t)}function xn(n){var t=On();return function(){var r=z(n),i;if(t){var o=z(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return wn(this,i)}}function wn(n,t){return t&&(U(t)==="object"||typeof t=="function")?t:kn(n)}function kn(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function On(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function z(n){return z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},z(n)}var Sn=function(n){_n(e,n);var t=xn(e);function e(){return vn(this,e),t.apply(this,arguments)}return bn(e,[{key:"init",value:function(){var i=this;this.onRender=function(o){for(var u=(i.getDrawBox()||i.activity.getBoundingBox()).add(i.pos.mod(i.sprite)).expand(f.from(i.sprite).multiply(2)).floor(),s=u.min.x;s<u.max.x;s+=i.sprite.w)for(var a=u.min.y;a<u.max.y;a+=i.sprite.h)i.sprite.draw(o,new f(s,a),i.getScale())}}},{key:"getBoundingBox",value:function(){return this.getDrawBox()}},{key:"isAbsolute",value:function(){return!0}}]),e}(v),De=Sn;function Rn(n,t,e){return e={path:t,exports:{},require:function(r,i){return Pn(r,i??e.path)}},n(e,e.exports),e.exports}function Pn(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Bn=Rn(function(n){(function(){var t=typeof window!="undefined"&&typeof window.document!="undefined"?window.document:{},e=n.exports,r=function(){for(var u,s=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],a=0,h=s.length,c={};a<h;a++)if(u=s[a],u&&u[1]in t){for(a=0;a<u.length;a++)c[s[0][a]]=u[a];return c}return!1}(),i={change:r.fullscreenchange,error:r.fullscreenerror},o={request:function(u,s){return new Promise(function(a,h){var c=function(){this.off("change",c),a()}.bind(this);this.on("change",c),u=u||t.documentElement;var p=u[r.requestFullscreen](s);p instanceof Promise&&p.then(c).catch(h)}.bind(this))},exit:function(){return new Promise(function(u,s){if(!this.isFullscreen){u();return}var a=function(){this.off("change",a),u()}.bind(this);this.on("change",a);var h=t[r.exitFullscreen]();h instanceof Promise&&h.then(a).catch(s)}.bind(this))},toggle:function(u,s){return this.isFullscreen?this.exit():this.request(u,s)},onchange:function(u){this.on("change",u)},onerror:function(u){this.on("error",u)},on:function(u,s){var a=i[u];a&&t.addEventListener(a,s,!1)},off:function(u,s){var a=i[u];a&&t.removeEventListener(a,s,!1)},raw:r};if(!r){e?n.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(o,{isFullscreen:{get:function(){return Boolean(t[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[r.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[r.fullscreenEnabled])}}}),e?n.exports=o:window.screenfull=o})()}),B=Bn;function X(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?X=function(e){return typeof e}:X=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(n)}function jn(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function En(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&fe(n,t)}function fe(n,t){return fe=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},fe(n,t)}function Mn(n){var t=In();return function(){var r=Y(n),i;if(t){var o=Y(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return An(this,i)}}function An(n,t){return t&&(X(t)==="object"||typeof t=="function")?t:Tn(n)}function Tn(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function In(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function Y(n){return Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Y(n)}var We=function(t,e){return e.renderOption.scale(e.isHover()?3.3:3)},Cn=function(n){En(e,n);var t=Mn(e);function e(r){var i;jn(this,e),i=t.call(this,r);var o=new De(null,ee.random()),u=k.idle(x.PinkMan),s=k.run(x.PinkMan);u.setLoop(4).setOnAnimationEnd(function(){return a.sprite=s.setLoop(6)}),s.setLoop(6).setOnAnimationEnd(function(){return a.sprite=u.setLoop(4)});var a=new v(f.from(r).multiply(.25,.175),s,d.absolute().scale(3)),h=new ue(f.from(r).multiply(.5,.1),"random race",d.absolute().scale(5)),c=new v(f.from(r).multiply(.95,.1),M.get("reset"),d.absolute().scale(3));if(i.addWidget(o.setOnUpdate(function(m){return o.pos.x-=m/10})),i.addWidget(a.setOnMouseClick(function(m){u.fps-=3,s.fps-=3,u.fps<0&&(u.fps=100,s.fps=100),i.addWidget(new ue(m.add(Math.random()*80-40,0),u.fps===100?"-100":"+3",d.absolute()).setRenderOption(d.scale(2).absolute().hue(Math.random()*360).brightness(6).contrast(2)).setOnUpdate(function(y,l){l.pos.y-=y/20,l.pos.y<0&&l.destroy()}))})),i.addWidget(h),i.addWidget(c.setOnMouseClick(function(){return o.setSprite(ee.random()),a.setSprite(k.hit(a.sprite.image).setLoop(1).setOnAnimationEnd(function(){a.setSprite(re.in().setLoop(0).setOnAnimationEnd(function(){var m=x.randomProperty();u.setImage(m),s.setImage(m),a.sprite=u.setLoop(1)}))})),!0}).setOnUpdate(We)),B.isEnabled){var p=new v(c.pos.subtract(72,0),M.get("fullscreen_enter"),d.absolute().scale(3));i.addWidget(p.setOnMouseClick(function(){return B.toggle(document.body)||!0}).setOnUpdate(We)),B.on("change",function(){p.sprite=M.get(B.isFullscreen?"fullscreen_exit":"fullscreen_enter")})}for(var b=function(y){var l=new v(new f(Math.random()*i.app.canvas.width,i.app.canvas.height));i.addWidget(l.setOnUpdate(function(ce){var J;((J=l.getBoundingBox())===null||J===void 0?void 0:J.minX)>i.getBoundingBox().add(i.camera).maxX&&(l.pos.x=i.camera.x,l.sprite=null),l.sprite||(l.renderOption.scale(Math.random()*5+2.5),l.sprite=k.run(x.randomProperty()).setFps(Math.random()*60+30));var G=l.sprite;G.update(ce),G.loop===-1&&(l.pos.x+=ce/5*(60/G.fps))}).setOnMouseClick(function(){if(l.sprite.loop===-1)return l.setSprite(k.hit(l.sprite.image).setLoop(0).setOnAnimationEnd(function(){l.setSprite(re.out().setLoop(0).setOnAnimationEnd(function(){l.pos.x=i.camera.x,l.sprite=null}))})),!0}))},g=0;g<30;++g)b(g);return new URLSearchParams(window.location.search).get("renderMouseClick")&&i.setOnMouseClick(function(m){var y=Ee.clone().setLoop(0),l=new v(m,y,d.absolute());y.setOnAnimationEnd(function(){return l.destroy()}),i.addWidget(l)}),i.setOnUpdate(function(m){i.camera.x+=m/10}),i}return e}(be),Ve=Cn;var Gr=function(){window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||function(n){return window.setTimeout(n,1e3/60)}}(),Date.now=Date.now||function(){return new Date().getTime()},Array.prototype.random=function(){var n=this.slice();return n[Math.floor(n.length*Math.random()<<0)]},Map.prototype.random=function(){return Array.from(this.values()).random()},Object.prototype.randomProperty=function(){return this[Object.keys(this).random()]},Object.prototype.clone=function(){var n=this,t={};return Object.keys(this).forEach(function(e){return t[e]=n[e]}),t},HTMLCanvasElement.prototype.calcMousePoint=function(n,t){var e=t/this.offsetWidth;return[(n.pageX-this.offsetLeft)*e,(n.pageY-this.offsetTop)*e]}}();document.addEventListener("DOMContentLoaded",function(){var n=new pe(document.getElementById("game"));n.addActivity(new Ve(n)),n.update()});
/*!
* screenfull
* v5.1.0 - 2020-12-24
* (c) Sindre Sorhus; MIT License
*/
//# sourceMappingURL=//.//index.js.map
